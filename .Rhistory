ggplot() +
aes(avg1800, ratio) +
guides(color = "none") +
geom_jitter() +
geom_label_repel(aes(label = `country name`)) +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c 2000. Cada punto es un país")
en1800 %>%
left_join(en2000, by = c("country name", "continente")) %>%
mutate(ratio = (avg2000 - avg1800)/avg1800) %>%
ggplot() +
aes(avg1800, ratio) +
guides(color = "none") +
geom_jitter() +
geom_label_repel(aes(label = `country name`), size = .9) +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c 2000. Cada punto es un país")
en1800 %>%
left_join(en2000, by = c("country name", "continente")) %>%
mutate(ratio = (avg2000 - avg1800)/avg1800) %>%
ggplot() +
aes(avg1800, ratio) +
guides(color = "none") +
geom_jitter() +
geom_label_repel(aes(label = `country name`), size = 2) +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c 2000. Cada punto es un país")
en1800 %>%
left_join(en2000, by = c("country name", "continente")) %>%
mutate(ratio = (avg2000 - avg1800)/avg1800) %>%
ggplot() +
aes(avg1800, ratio) +
guides(color = "none") +
geom_jitter() +
geom_text_repel(aes(label = `country name`), size = 2) +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c 2000. Cada punto es un país")
en1800 %>%
left_join(en2000, by = c("country name", "continente")) %>%
mutate(ratio = (avg2000 - avg1800)/avg1800) %>%
ggplot() +
aes(avg1800, ratio) +
guides(color = "none") +
geom_jitter() +
geom_text_repel(aes(label = `country name`), size = 5) +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c 2000. Cada punto es un país")
en1800 %>%
left_join(en2000, by = c("country name", "continente")) %>%
mutate(ratio = (avg2000 - avg1800)/avg1800) %>%
ggplot() +
aes(avg1800, ratio) +
guides(color = "none") +
geom_jitter() +
geom_text_repel(aes(label = `country name`), size = 3) +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c 2000. Cada punto es un país")
en1800 %>%
left_join(en2000, by = c("country name", "continente")) %>%
mutate(ratio = (avg2000 - avg1800)/avg1800) %>%
ggplot() +
aes(avg1800, ratio, color = continente) +
guides(color = "none") +
geom_jitter() +
geom_text_repel(aes(label = `country name`), size = 3) +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c2000. Cada punto es un país")
en1800 %>%
left_join(en2000, by = c("country name", "continente")) %>%
mutate(ratio = (avg2000 - avg1800)/avg1800) %>%
ggplot() +
aes(avg1800, ratio, color = continente) +
guides(color = "none") +
geom_jitter() +
geom_text_repel(aes(label = `country name`), size = 3, color = "black") +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c2000. Cada punto es un país")
en1800 %>%
left_join(en2000, by = c("country name", "continente")) %>%
mutate(ratio = (avg2000 - avg1800)/avg1800) %>%
ggplot() +
aes(avg1800, ratio, color = continente) +
guides(color = "none") +
geom_jitter() +
geom_text_repel(aes(label = `country name`), size = 3, color = "black") +
geom_hline(yintercept = 0) +
facet_wrap(.~continente) +
theme(strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12)) +
labs(y = "Δestatura",
x="Estatura media entre 1800 a 1820 (cm.)",
title = "Variación en la estatura global población adulta",
subtitle = "Eje Y es tasa de variación en estatura entre c1800 y c2000. Cada punto es un país")
vida <- read.csv("data/life-expectancy.csv")
colnames(vida)[4] <- "LE"
vida$continente <- countrycode(vida$Code,
origin = "iso3c",
destination = "continent")
temp <- vida %>%
select(Entity, Code) %>%
unique()
pov <- read.csv("data/pobreza.csv") %>%
filter(ppp_version == 2017,
welfare_type != "",
reporting_level == "rural")
View(pov)
pov <- pov %>%
left_join(temp, by = c("country"="Entity"))
pov$continente <- countrycode(pov$Code,
origin = "iso3c",
destination = "continent")
povertys <- pov %>%
select(1, 2, 109, 110, 4, 7:10)
lapply(unique(povertys$Code), function(x){
temp <- povertys %>%
filter(Code == x) %>%
group_by(welfare_type) %>%
summarise(n = n()) %>%
filter(n == max(n)) %>%
pull(welfare_type)
data.frame(pais = x, tipo = temp)
}) %>%
do.call("rbind", .) %>%
as.data.frame() -> mainsrvy
mainsrvy <- mainsrvy %>%
filter(!(pais == "SYC" & tipo == "consumption"))
povertys <- povertys %>%
left_join(mainsrvy, by = c("Code" = "pais"))
povertys <- povertys %>%
filter(welfare_type == tipo)
lapply(unique(povertys$Code), function(i){
temp <- povertys %>%
select(Code, year,
headcount_ratio_international_povline,
headcount_ratio_lower_mid_income_povline,
headcount_ratio_upper_mid_income_povline) %>%
filter(Code == i)
temp$pov1_hat <- tryCatch({
hpfilter(temp$headcount_ratio_international_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp$pov2_hat <- tryCatch({
hpfilter(temp$headcount_ratio_lower_mid_income_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp$pov3_hat <- tryCatch({
hpfilter(temp$headcount_ratio_upper_mid_income_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp <- temp %>%
select(1, 2, 6:8)
temp
}) %>%
do.call("rbind", .) %>%
as.data.frame() -> hd_hats
colnames(hd_hats)[3:5] <- c("pov1", "pov2", "pov3")
View(povertys)
povertys2 <- povertys %>%
left_join(hd_hats,
by = c("Code", "year"))
povertys2 %>%
group_by(continente, welfare_type) %>%
count() %>%
spread(welfare_type, n)
povertys2$country %>% unique()
povertys2 %>%
group_by(Code) %>%
mutate(var = last(pov1) - first(pov1)) %>%
ggplot() +
aes(year, pov1, color = ifelse(var > 0, "asd", "asdasd")) +
guides(color = "none") +
scale_color_manual(values = c("darkred", "green")) +
geom_line(size = .9) +
facet_wrap(.~reorder(Code, var)) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
View(povertys2)
lapply(unique(povertys$Code), function(i){
temp <- povertys %>%
select(Code, year,
headcount_ratio_international_povline,
headcount_ratio_lower_mid_income_povline,
headcount_ratio_upper_mid_income_povline) %>%
filter(Code == i)
temp$pov1_hat <- tryCatch({
hpfilter(temp$headcount_ratio_international_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp$pov2_hat <- tryCatch({
hpfilter(temp$headcount_ratio_lower_mid_income_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp$pov3_hat <- tryCatch({
hpfilter(temp$headcount_ratio_upper_mid_income_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp <- temp %>%
select(1, 2, 6:8)
temp
}) %>%
do.call("rbind", .) %>%
as.data.frame() -> hd_hats
View(hd_hats)
library(mFilter)
lapply(unique(povertys$Code), function(i){
temp <- povertys %>%
select(Code, year,
headcount_ratio_international_povline,
headcount_ratio_lower_mid_income_povline,
headcount_ratio_upper_mid_income_povline) %>%
filter(Code == i)
temp$pov1_hat <- tryCatch({
hpfilter(temp$headcount_ratio_international_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp$pov2_hat <- tryCatch({
hpfilter(temp$headcount_ratio_lower_mid_income_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp$pov3_hat <- tryCatch({
hpfilter(temp$headcount_ratio_upper_mid_income_povline,
type = "lambda",
freq = 100)$trend
}, error = function(x){
return(NA)
} )
temp <- temp %>%
select(1, 2, 6:8)
temp
}) %>%
do.call("rbind", .) %>%
as.data.frame() -> hd_hats
colnames(hd_hats)[3:5] <- c("pov1", "pov2", "pov3")
povertys2 <- povertys %>%
left_join(hd_hats,
by = c("Code", "year"))
povertys2 %>%
group_by(continente, welfare_type) %>%
count() %>%
spread(welfare_type, n)
povertys2 %>%
group_by(Code) %>%
mutate(var = last(pov1) - first(pov1)) %>%
ggplot() +
aes(year, pov1, color = ifelse(var > 0, "asd", "asdasd")) +
guides(color = "none") +
scale_color_manual(values = c("darkred", "green")) +
geom_line(size = .9) +
facet_wrap(.~reorder(Code, var)) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
filter(!is.na(pov1)) +
group_by(Code) %>%
# mutate(var = last(pov1) - first(pov1)) %>%
ggplot() +
aes(x = year) +
# guides(color = "none") +
geom_line(aes(y = pov1, color = "Pobreza absoluta"), size = 1) +
facet_wrap(.~reorder(Code, var)) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
filter(!is.na(pov1)) +
group_by(Code) %>%
# mutate(var = last(pov1) - first(pov1)) %>%
ggplot() +
aes(x = year) +
# guides(color = "none") +
geom_line(aes(y = pov1, color = "Pobreza absoluta"), size = 1) +
facet_wrap(.~reorder(Code, var)) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
filter(!is.na(pov1)) +
group_by(Code) %>%
# mutate(var = last(pov1) - first(pov1)) %>%
ggplot() +
aes(x = year) +
# guides(color = "none") +
geom_line(aes(y = pov1, color = "Pobreza absoluta"), size = 1) +
# facet_wrap(.~reorder(Code, var)) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
filter(!is.na(pov1)) %>%
group_by(Code) %>%
# mutate(var = last(pov1) - first(pov1)) %>%
ggplot() +
aes(x = year) +
# guides(color = "none") +
geom_line(aes(y = pov1, color = "Pobreza absoluta"), size = 1) +
facet_wrap(.~reorder(Code, var)) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
facet_wrap(.~Code) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
geom_line(size = 1) +
facet_wrap(.~Code) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
geom_line(size = 1) +
facet_wrap(.~Code) +
scale_color_manual(labels = c("Absoluta", "Al $3.65", "Al $6.85")) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
geom_line(size = 1) +
facet_wrap(.~Code) +
scale_color_manual(values = c("pov1", "pov2", "pov3"),
labels = c("Absoluta", "Al $3.65", "Al $6.85")) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
geom_line(size = 1) +
facet_wrap(.~Code) +
scale_color_manual(values = c("darkred", "darkgoldenrod" ,"darkgreen"),
labels = c("Absoluta", "$3.65 al día", "$6.85 al día")) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "A) Tendencia pobreza absoluta")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
geom_line(size = 1) +
facet_wrap(.~Code) +
scale_color_manual(values = c("darkred", "darkgoldenrod" ,"darkgreen"),
labels = c("Absoluta", "$3.65 al día", "$6.85 al día")) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "Pobreza en zonas rurales",
color = "")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
geom_line(size = 1) +
facet_wrap(.~Code) +
# scale_color_manual(values = c("darkred", "darkgoldenrod" ,"darkgreen"),
#                    labels = c("Absoluta", "$3.65 al día", "$6.85 al día")) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "Pobreza en zonas rurales",
color = "Umbral pobreza")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
geom_line(size = 1) +
facet_wrap(.~Code) +
scale_color_manual(values = c("darkred", "darkgoldenrod" ,"darkgreen"),
labels = c("Absoluta", "$3.65 al día", "$6.85 al día")) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "Pobreza en zonas rurales",
color = "Umbral pobreza")
povertys2 %>%
gather("tipo", "pov",11:13) %>%
filter(!is.na(pov)) %>%
ggplot() +
aes(year, pov, color = tipo) +
# guides(color = "none") +
geom_line(size = 1) +
facet_wrap(.~Code) +
scale_color_manual(values = c("darkred", "darkgoldenrod" ,"darkgreen"),
labels = c("Absoluta", "$3.65 al día", "$6.85 al día")) +
scale_x_continuous(breaks = seq(1980, 2020, 20)) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = .5),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
labs(title = "Pobreza en zonas rurales",
subtitle = "Rectas representan tendencia estimada por filtro Hodrick–Prescott parámetro suavización 100",
color = "Umbral pobreza")
unique(pov$country)
